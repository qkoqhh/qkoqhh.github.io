<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#33363b">
    <meta name="msapplication-TileColor" content="#33363b">
    
    
    
    
    <meta name="keywords" content="Program, ARIA, Hexo">
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    
    
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    
    
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#33363b">
    
    
    <link rel="manifest" href="/favicons/site.webmanifest">
    
    
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    
    
    <link rel="alternate" href="/atom.xml" title="qkoqhh" type="application/atom+xml">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
    
    
    <link rel="stylesheet" type="text/css" href="/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/css/index.css">
    
    <link rel="stylesheet" type="text/css" href="/css/sidebar.css">
    
    
<link rel="stylesheet" type="text/css" href="/css/page.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/css/atom-one-dark.css">
    <link rel="stylesheet" type="text/css" href="/css/lightgallery.min.css">
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script defer type="text/javascript" src="/js/util.js"></script>
    <script defer type="text/javascript" src="/js/scrollspy.js"></script>
    <script defer type="text/javascript" src="/js/fontawesome-all.min.js"></script>
    <script defer type="text/javascript" src="/js/lightgallery.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-fullscreen.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-hash.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-pager.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-thumbnail.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-zoom.min.js"></script>
    
    <script defer src="/js/busuanzi.pure.mini.js"></script>
    
    
    <script defer type="text/javascript" src="/js/search.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var searchPath = "search.xml";
      if (searchPath.length === 0) {
        searchPath = "search.xml";
      }
      var path = "/" + searchPath;
      searchFunc(path, "search-input", "search-result");
    });
    </script>
    
    
    
    <script defer type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ["script", "noscript", "style", "textarea", "pre", "code"]
      }
    });
    </script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += " has-jax";
      }
    });
    </script>
    
    
    <script defer type="text/javascript" src="/js/index.js"></script>
    
    <script defer type="text/javascript" src="/js/custom.js"></script>


    <title>cf1111D(å¯é€†èƒŒåŒ…) | qkoqhh - ä»€ä¹ˆéƒ½æ²¡æœ‰</title>
  </head>
  <body itemscope="" itemtype="http://schema.org/WebPage" lang="zh_CN" data-spy="scroll" data-target=".list-group">
    
<header id="header" class="header" style="background: #33363b;">
  <div class="container">
    <div class="header-container">
      <div class="header-title">
        <h1 class="title"><a href="/">qkoqhh</a></h1>
        <h2 class="subtitle">ä»€ä¹ˆéƒ½æ²¡æœ‰</h2>
      </div>
      
      <div class="logo">
        <img src="/images/logo.png" alt="logo">
      </div>
      
    </div>
    <nav id="nav" class="nav">
      <a id="nav-toggle" class="nav-toggle" aria-hidden="true"><i class="fas fa-bars" aria-label="åˆ‡æ¢å¯¼èˆªæ "></i></a>
      <ul id="menu" role="menubar" aria-hidden="false">
        
        <li role="menuitem"><a href="/">é¦–é¡µ</a></li>
        
        <li role="menuitem"><a href="/archives/">å½’æ¡£</a></li>
        
        <li role="menuitem"><a href="/tags/">æ ‡ç­¾</a></li>
        
        <li role="menuitem"><a href="/about/">å…³äº</a></li>
        
      </ul>
    </nav>
  </div>
</header>




    <main id="main" class="main">
      <div class="container">
        <div class="main-container">
          <div class="content">
            
<div id="post" class="page">
  
  <article class="article post card animate" itemscope="" itemtype="http://schema.org/Article">
    <div class="post-block">
      <link itemprop="mainEntityOfPage" href="http://yoursite.com/cf1111D/">
      <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
       <meta itemprop="name" content="qkoqhh">
       <meta itemprop="description" content="å·²é™·å…¥å¹»æƒ³">
       <meta itemprop="image" content="/images/avatar.jpg">
      </span>
      <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
       <meta itemprop="name" content="qkoqhh">
      </span>
    </div>
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">cf1111D(å¯é€†èƒŒåŒ…)</h1>
      <div class="post-meta">
        
        <span class="post-date">
          <i class="far fa-calendar-plus"></i><span><time title="post-date" itemprop="dateCreated datePublished" datetime="2019-02-10T11:37:04+08:00">2019-02-10 11:37:04</time></span>
        </span>
        
        
        
        
        
        <span class="post-meta-divider divider">|</span>
        
        <span class="post-comment-count">
          <i class="far fa-comments"></i><span><a href="/cf1111D/#disqus_thread" itemprop="discussionUrl"><span class="post-comment-count disqus-comment-count" data-disqus-identifier="cf1111D/" itemprop="commentCount"></span></a></span>
        </span>
        
        
      </div>
    </header>
    <main class="post-main" itemprop="articleBody">
      <h3 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h3><p><a href="http://codeforces.com/problemset/problem/1111/D" target="_blank" rel="noopener">http://codeforces.com/problemset/problem/1111/D</a></p>
<h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºå¶æ•°çš„çš„å­—ç¬¦ä¸²(ä»…åŒ…å«å­—æ¯)ï¼Œå¯ä»¥éšæ„äº¤æ¢ä»»æ„ä¸¤ä¸ªå­—ç¬¦ï¼Œå…ˆè¦å°†å­—ç¬¦ä¸²åˆ†æˆå·¦å³ä¸¤åŠéƒ¨åˆ†ï¼Œç»™å®š $q$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®åŒ…å« $x$ å’Œ $y$ ï¼Œè¦æ±‚æ»¡è¶³ä¸‹è¿°è¦æ±‚çš„æ’åˆ—æ–¹æ¡ˆæ•°ï¼š</p>
<ol>
<li>åŒä¸€ç§å­—ç¬¦ä¸åŒæ—¶å‡ºç°åœ¨å­—ç¬¦ä¸²å·¦å³ä¸¤åŠ</li>
<li>$x$ ã€ $y$ ä»£è¡¨çš„å­—ç¬¦åº”å‡ºç°åœ¨åŒä¸€ä¾§</li>
</ol>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>äº‹å®ä¸Šåªè¦è€ƒè™‘å“ªäº›å­—ç¬¦å‡ºç°åœ¨å·¦åŠéƒ¨åˆ†å°±å¯ä»¥äº†ç„¶åå†å¯¹è¿™äº›å­—ç¬¦åˆ†åˆ«è¿›è¡Œæ’åˆ—ï¼Œè€Œæ’åˆ—æ–¹æ¡ˆæ•°æ€»æ˜¯å›ºå®šçš„ï¼Œä¸º $\frac{\frac{n}{2}!\frac{n}{2}!}{\prod a_i!}$ (å…¶ä¸­$a_i$ä¸ºiå­—ç¬¦å‡ºç°çš„ä¸ªæ•°)ã€‚</p>
<p>ç„¶åå°±è½¬åŒ–æˆä¸€ä¸ª01è®¡æ•°èƒŒåŒ…äº†ï¼Œç”±äºè¿™ä¸ªèƒŒåŒ…æ˜¯å¯é€†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠç‰©å“è£…è¿›å»ä¹‹åå†å»æ’¤é”€ã€‚ç›´æ¥æ’é”€å¤æ‚åº¦æ˜¯ $O(qn)$ ä¸èƒ½æ¥å—ï¼Œä»”ç»†åˆ†æè¯¢é—®ç§ç±»æœ€å¤šåªæœ‰ $52*52$ ç§ï¼Œé‚£ä¹ˆç›´æ¥é¢„å¤„ç†è¿™äº›æƒ…å†µå°±å¯ä»¥äº†ï¼Œå¤æ‚åº¦ä¸º $O(52^2n)$ ã€‚å®é™…ä¸Šå¤æ‚åº¦æ²¡æœ‰é‚£ä¹ˆé«˜ï¼Œå› ä¸ºæˆ‘ä»¬åªè¦æ±‚èƒŒåŒ…é‡ŒæŸä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œè€Œæ’¤é”€èƒŒåŒ…çš„è¡¨è¾¾å¼æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥å¯ä»¥æ‰‹åŠ¨ç®—å‡ºè¦æ±‚çš„é‚£ä¸€é¡¹ï¼Œè¿™æ ·æ’¤é”€çš„å¤æ‚åº¦å¯ä»¥é™æˆ $O(n/v)$ ï¼Œä¸ºäº†é¿å…æé™æ•°æ®çš„å‡ºç°å¯ä»¥æ’åºå»é‡ï¼Œç„¶åå¤æ‚åº¦å¯ä»¥é™è‡³ $O(52nlogn)$ ã€‚</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**<br> *ã€€ã€€ã€€ã€€ã€€ã€€  ã€€ã€€â”â”“ã€€ã€€ ã€€â”â”“<br> * ã€€ã€€ã€€ã€€ã€€  ã€€ã€€â”â”›â”—â”â”â”â”â”â”â”â”›â”—â”â”â”â”“<br> * ã€€ã€€ã€€ã€€ã€€  ã€€ã€€â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ ã€€<br> * ã€€ã€€ã€€ã€€ã€€  ã€€ã€€â”ƒã€€ã€€ã€€â”ã€€ã€€ ã€€â”ƒ<br> * ã€€ã€€ã€€ã€€ã€€  ã€€ã€€â”ƒã€€ï¼ã€€ã€€ã€€ï¼œã€€â”ƒ<br> * ã€€ã€€ã€€ã€€ã€€  ã€€ã€€â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ<br> * ã€€ã€€ã€€ã€€ã€€  ã€€ã€€â”ƒ...ã€€âŒ’ã€€... ã€€â”ƒ<br> * ã€€ã€€ã€€ã€€ã€€ã€€  ã€€â”ƒ              â”ƒ<br> * ã€€ã€€ã€€ã€€ã€€ã€€  ã€€â”—â”â”“          â”â”â”›<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ          â”ƒã€€Code is far away from bug with the animal protectingã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ          â”ƒ   ç¥å…½ä¿ä½‘,ä»£ç æ— bug<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ          â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ          â”ƒ  ã€€ã€€ã€€ã€€ã€€ã€€<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ          â”ƒ<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ          â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ          â”—â”â”â”â”“<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ              â”£â”“<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ              â”â”›<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”—â”“â”“â”â”â”â”â”â”â”â”â”â”³â”“â”â”›<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒâ”«â”«       â”ƒâ”«â”«<br> * ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”—â”»â”›       â”—â”»â”›<br> */</span> <br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stack&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;set&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bitset&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> inc(i,l,r) for(int i=l;i&lt;=r;i++)</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dec(i,l,r) for(int i=l;i&gt;=r;i--)</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> link(x) for(edge *j=h[x];j;j=j-&gt;next)</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> mem(a) memset(a,0,sizeof(a))</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ll long long</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> eps 1e-8</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> succ(x) (1&lt;&lt;x)</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> lowbit(x) (x&amp;(-x))</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> sqr(x) ((x)*(x))</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> mid (x+y&gt;&gt;1)</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NM 100005</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> nm 200005</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> pi 3.1415926535897931</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf=<span class="hljs-number">1e9</span>+<span class="hljs-number">7</span>;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<br><span class="hljs-function">ll <span class="hljs-title">read</span><span class="hljs-params">()</span></span>&#123;<br>    ll x=<span class="hljs-number">0</span>,f=<span class="hljs-number">1</span>;<span class="hljs-keyword">char</span> ch=getchar();<br>    <span class="hljs-keyword">while</span>(!<span class="hljs-built_in">isdigit</span>(ch))&#123;<span class="hljs-keyword">if</span>(ch==<span class="hljs-string">'-'</span>)f=<span class="hljs-number">-1</span>;ch=getchar();&#125;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">isdigit</span>(ch))x=x*<span class="hljs-number">10</span>+ch-<span class="hljs-string">'0'</span>,ch=getchar();<br>    <span class="hljs-keyword">return</span> f*x;<br>&#125;<br> <br> <br><br><br><br><br>ll ans,p[NM],inv[NM],invp[NM];<br><span class="hljs-keyword">char</span> s[NM];<br><span class="hljs-keyword">int</span> n,m,a[<span class="hljs-number">53</span>],_x,_y,d[<span class="hljs-number">53</span>][<span class="hljs-number">53</span>];<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tmp</span>&#123;</span><br>    <span class="hljs-keyword">int</span> d[NM];<br>    <span class="hljs-keyword">void</span> <span class="hljs-keyword">operator</span>*=(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span>&amp;t)&#123;dec(i,n,t)d[i]+=d[i-t],d[i]%=inf;&#125;<br>    <span class="hljs-keyword">void</span> <span class="hljs-keyword">operator</span>/=(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span>&amp;t)&#123;inc(i,t,n)d[i]-=d[i-t],d[i]%=inf;&#125;<br>&#125;cnt[<span class="hljs-number">53</span>];<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fun</span><span class="hljs-params">(<span class="hljs-keyword">char</span> t)</span></span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-string">'a'</span>&lt;=t&amp;&amp;t&lt;=<span class="hljs-string">'z'</span>?t-<span class="hljs-string">'a'</span>+<span class="hljs-number">1</span>:t-<span class="hljs-string">'A'</span>+<span class="hljs-number">27</span>;&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%s"</span>,s+<span class="hljs-number">1</span>);n=<span class="hljs-built_in">strlen</span>(s+<span class="hljs-number">1</span>);<br>    p[<span class="hljs-number">0</span>]=invp[<span class="hljs-number">0</span>]=inv[<span class="hljs-number">1</span>]=invp[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;<br>    inc(i,<span class="hljs-number">1</span>,n)p[i]=p[i<span class="hljs-number">-1</span>]*i%inf;<br>    inc(i,<span class="hljs-number">2</span>,n)inv[i]=inv[inf%i]*(inf-inf/i)%inf,invp[i]=invp[i<span class="hljs-number">-1</span>]*inv[i]%inf;<br>    inc(i,<span class="hljs-number">1</span>,n)a[fun(s[i])]++;<br>    n&gt;&gt;=<span class="hljs-number">1</span>;<br>    ans=p[n]*p[n]%inf;<br>    inc(i,<span class="hljs-number">1</span>,<span class="hljs-number">52</span>)ans*=invp[a[i]],ans%=inf;<br>    ans&lt;&lt;=<span class="hljs-number">1</span>;ans%=inf;<br>    cnt[<span class="hljs-number">0</span>].d[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;<br>    inc(i,<span class="hljs-number">1</span>,<span class="hljs-number">52</span>)<span class="hljs-keyword">if</span>(a[i])cnt[<span class="hljs-number">0</span>]*=a[i];<br>    inc(i,<span class="hljs-number">1</span>,<span class="hljs-number">52</span>)<span class="hljs-keyword">if</span>(a[i])cnt[i]=cnt[<span class="hljs-number">0</span>],cnt[i]/=a[i];<br>    inc(i,<span class="hljs-number">1</span>,<span class="hljs-number">52</span>)<span class="hljs-keyword">if</span>(a[i])inc(j,i+<span class="hljs-number">1</span>,<span class="hljs-number">52</span>)<span class="hljs-keyword">if</span>(a[j])&#123;<br>	<span class="hljs-keyword">int</span> t=<span class="hljs-number">1</span>;<br>	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k=n;k&gt;=<span class="hljs-number">0</span>;k-=a[j],t=-t)<br>	    d[i][j]+=t*cnt[i].d[k],d[i][j]%=inf;<br>    &#125;<br>    inc(i,<span class="hljs-number">1</span>,<span class="hljs-number">52</span>)inc(j,<span class="hljs-number">1</span>,i<span class="hljs-number">-1</span>)d[i][j]=d[j][i];<br>    m=read();<span class="hljs-keyword">while</span>(m--)&#123;<br>	_x=read();_y=read();<br>	<span class="hljs-keyword">if</span>(s[_x]==s[_y])<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>,(cnt[fun(s[_x])].d[n]+inf)*ans%inf);<br>	<span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>,(d[fun(s[_x])][fun(s[_y])]+inf)*ans%inf);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><br></p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p>D. Destroy the Colony<br>time limit per test<br>2 seconds<br>memory limit per test<br>512 megabytes<br>input<br>standard input<br>output<br>standard output</p>
<p>There is a colony of villains with several holes aligned in a row, where each hole contains exactly one villain.</p>
<p>Each colony arrangement can be expressed as a string of even length, where the ğ‘–<br>-th character of the string represents the type of villain in the ğ‘–</p>
<p>-th hole.</p>
<p>Iron Man can destroy a colony only if the colony arrangement is such that all villains of a certain type either live in the first half of the colony or in the second half of the colony.</p>
<p>His assistant Jarvis has a special power. It can swap villains of any two holes, i.e. swap any two characters in the string; he can do this operation any number of times.</p>
<p>Now Iron Man asks Jarvis ğ‘<br>questions. In each question, he gives Jarvis two numbers ğ‘¥ and ğ‘¦. Jarvis has to tell Iron Man the number of distinct colony arrangements he can create from the original one using his powers such that all villains having the same type as those originally living in ğ‘¥-th hole or ğ‘¦</p>
<p>-th hole live in the same half and the Iron Man can destroy that colony arrangement.</p>
<p>Two colony arrangements are considered to be different if there exists a hole such that different types of villains are present in that hole in the arrangements.<br>Input</p>
<p>The first line contains a string ğ‘ <br>(2â‰¤|ğ‘ |â‰¤105), representing the initial colony arrangement. String ğ‘ </p>
<p>can have both lowercase and uppercase English letters and its length is even.</p>
<p>The second line contains a single integer ğ‘<br>(1â‰¤ğ‘â‰¤105</p>
<p>) â€” the number of questions.</p>
<p>The ğ‘–<br>-th of the next ğ‘ lines contains two integers ğ‘¥ğ‘– and ğ‘¦ğ‘– (1â‰¤ğ‘¥ğ‘–,ğ‘¦ğ‘–â‰¤|ğ‘ |, ğ‘¥ğ‘–â‰ ğ‘¦ğ‘–) â€” the two numbers given to the Jarvis for the ğ‘–</p>
<p>-th question.<br>Output</p>
<p>For each question output the number of arrangements possible modulo 109+7</p>
<p>.<br>Examples<br>Input<br>Copy</p>
<p>abba<br>2<br>1 4<br>1 2</p>
<p>Output<br>Copy</p>
<p>2<br>0</p>
<p>Input<br>Copy</p>
<p>AAaa<br>2<br>1 2<br>1 3</p>
<p>Output<br>Copy</p>
<p>2<br>0</p>
<p>Input<br>Copy</p>
<p>abcd<br>1<br>1 3</p>
<p>Output<br>Copy</p>
<p>8</p>
<p>Note</p>
<p>Consider the first example. For the first question, the possible arrangements are â€œaabbâ€ and â€œbbaaâ€, and for the second question, index 1<br>contains â€˜aâ€™ and index 2</p>
<p>contains â€˜bâ€™ and there is no valid arrangement in which all â€˜aâ€™ and â€˜bâ€™ are in the same half.</p>

    </main>
    <footer class="post-footer">
      
      <div class="post-tags">
        
        <a class="post-tag button" href="/tags/DP/" rel="tag"><i class="fas fa-tags"></i>DP</a>
        
        <a class="post-tag button" href="/tags/ç”Ÿæˆå‡½æ•°/" rel="tag"><i class="fas fa-tags"></i>ç”Ÿæˆå‡½æ•°</a>
        
      </div>
      
    </footer>
  </article>
  
  
  <nav class="page-nav">
    <div class="page-nav-next page-nav-item">
      
      <a href="/hexo2/" rel="next" title="hexoççŒ´æ—¥è®°äºŒ"><i class="fas fa-angle-left"></i><span class="nav-title">hexoççŒ´æ—¥è®°äºŒ</span></a>
      
    </div>
    <div class="page-nav-prev page-nav-item">
      
    </div>
  </nav>
  
  
  

<div class="comments" id="comments">
  
  <script defer id="dsq-count-scr" src="//qkoqhh.disqus.com/count.js"></script>
  
  <div id="disqus_thread" class="disqus_thread"></div>
  <script type="text/javascript">
  var disqus_config = function () {
    this.page.url = "http://yoursite.com/cf1111D/";
    this.page.identifier = "cf1111D/";
  };
  (function() {
    var d = document, s = d.createElement("script");
    s.src = "https://qkoqhh.disqus.com/embed.js";
    s.setAttribute("data-timestamp", +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  
  
</div>



  
</div>

          </div>
          
          
          
<aside class="sidebar" id="sidebar" style="background: url(/images/background.png);">
  
  <div class="search">
    <div class="form-group">
      <i class="fas fa-search"></i><input type="search" id="search-input" name="q" results="0" placeholder="æœç´¢" class="form-control">
    </div>
  </div>
  <div class="search-result-box" id="search-result"></div>
  
  
<div class="info sidebar-item" id="info">
  
  <img class="author-avatar" src="/images/avatar.jpg" alt="qkoqhh">
  
  <h1 class="author-name">qkoqhh</h1>
  <h2 class="author-description">å·²é™·å…¥å¹»æƒ³</h2>
  <div class="site-count">
    
    <div class="archives-count">
      <div class="site-count-title">å½’æ¡£</div>
      <div><a href="/archives/">6</a></div>
    </div>
    
    
    
    
    <span class="site-count-divider divider">|</span>
    
    <div class="tags-count">
      <div class="site-count-title">æ ‡ç­¾</div>
      <div><a href="/tags/">6</a></div>
    </div>
    
  </div>
  
  <div class="rss">
    <a class="rss-link button sidebar-item" href="/atom.xml"><i class="fas fa-rss"></i>RSS</a>
  </div>
  
</div>


  <div class="sidebar-sticky">
    
    
    
    
    
    <hr>
    <div class="post-toc sidebar-item" id="toc-div">
      <div><i class="fas fa-list-ol"></i>æ–‡ç« ç›®å½•</div>
      <div class="post-toc-content"><ol class="list-group toc"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#é¢˜ç›®é“¾æ¥"><span class="toc-text">é¢˜ç›®é“¾æ¥</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#é¢˜æ„"><span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#é¢˜è§£"><span class="toc-text">é¢˜è§£</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#ä»£ç "><span class="toc-text">ä»£ç </span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#é¢˜é¢"><span class="toc-text">é¢˜é¢</span></a></li></ol></div>
    </div>
    
    
    
    
    <hr>
    <div class="blogroll sidebar-item">
      <div><i class="fas fa-link"></i>å‹æƒ…é“¾æ¥</div>
      <ul>
        
        <li><i class="fas fa-link"></i><a href="http://www.cnblogs.com/JSZX11556/" target="_blank">JSZX11556</a></li>
        
        <li><i class="fas fa-link"></i><a href="http://hzwer.com/" target="_blank">hzwer</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://blog.csdn.net/CreationAugust" target="_blank">CreationAugust</a></li>
        
        <li><i class="fas fa-link"></i><a href="http://www.cnblogs.com/wang9897/" target="_blank">wang9897</a></li>
        
        <li><i class="fas fa-link"></i><a href="http://www.cnblogs.com/greenty1208/" target="_blank">Greenty_Q</a></li>
        
        <li><i class="fas fa-link"></i><a href="arch0n.sumblog.cn" target="_blank">Arch0n</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://shijieyywd.com" target="_blank">shijieyywd</a></li>
        
      </ul>
    </div>
    
  </div>
</aside>


          
        </div>
      </div>
    </main>
    
<footer id="footer" class="footer" style="background: #33363b;">
  <div class="container">
    <div class="back-to-top">
      <button id="back-to-top"><i class="fas fa-angle-double-up" aria-label="å›åˆ°é¡¶éƒ¨"></i></button>
    </div>
    <div class="footer-container">
      <div class="footer-left">
        <div class="copyright">
          <span class="author">qkoqhh</span><span class="year"><i class="far fa-copyright"></i>2017 - 2019</span><span class="creative-commons"><i class="fab fa-creative-commons"></i><a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">BY-NC 4.0</a></span>
        </div>
        
        <div class="busuanzi">
          <span id="busuanzi_container_site_pv"><i class="fas fa-eye" aria-label="ç«™ç‚¹ç‚¹å‡»é‡" aria-hidden="false"></i><span id="busuanzi_value_site_pv"></span></span><span id="busuanzi_container_site_uv"><i class="fas fa-user" aria-label="ç«™ç‚¹ç”¨æˆ·æ•°" aria-hidden="false"></i><span id="busuanzi_value_site_uv"></span></span><span id="busuanzi_container_page_pv"><i class="far fa-file-alt"></i><span id="busuanzi_value_page_pv" aria-label="é¡µé¢ç‚¹å‡»é‡" aria-hidden="false"></span></span>
        </div>
        
      </div>
      <div class="footer-right">
        <div class="custom-info">
          
          æ‰˜ç®¡äº<i class="fab fa-github-alt"></i><a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
          
        </div>
        <div class="powered-by">
          ç”± <a href="https://hexo.io/" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ <a href="https://github.com/AlynxZhou/hexo-theme-aria/" target="_blank">ARIA</a>
        </div>
      </div>
    </div>
  </div>
</footer>


  <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":210},"mobile":{"show":true},"log":false});</script></body>
</html>
